<div class="woocommerce-MyAccount-content tab-content" id="tab3">
	<input type="hidden" id="pKey" value="<%=publicKey%>">
	<div class="woocommerce-notices-wrapper"></div>

	<script src="https://sdk.mercadopago.com/js/v2"></script>
	<table id="tabela-dados" class="woocommerce-orders-table woocommerce-MyAccount-orders shop_table shop_table_responsive my_account_orders account-orders-table col-12">
		<thead>
			<tr>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-number"><span class="nobr">Pedido</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-number"><span class="nobr">Cliente</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-number"><span class="nobr">CPF</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-number"><span class="nobr">Contato</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-number"><span class="nobr">E-mail</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-date"><span class="nobr">Data</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-status"><span class="nobr">Status</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-total"><span class="nobr">Total</span></th>
									<th class="woocommerce-orders-table__header woocommerce-orders-table__header-order-actions"><span class="nobr">Ações</span></th>
							</tr>
		</thead>
	
		
	



			<tbody>
		
		<%if(user){%>
		<%user.orders.forEach(ord=>{%>
		
				<tr class="woocommerce-orders-table__row woocommerce-orders-table__row--status-cancelled order">
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-number" data-title="Pedido">		
									<%if(ord.order && ord.order.id){%>
												<a href="#">#<%=ord.order.id%></a>
												<%}else{%>
													ID de pagamento não encontrado
													<%}%>
								</td>
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-number" data-title="Cliente">
							<%if(ord.order.card && ord.order.card.cardholder){%>
										<a href="#"><%=ord.order.card.cardholder.name%></a>
									<%}else{%>
										<a href="#">Nome não encontrado</a>
										<%}%>
								</td>
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-number" data-title="CPF">
									<%if(ord.order.payer && ord.order.payer.identification){%>
									<a href="#"><%=ord.order.payer.identification.number%></a>
									<%}else{%>
										<a href="#">CPF ou CNPJ não encontrado</a>
										<%}%>%>
								</td>

								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-number" data-title="Contato">
									<%if(ord.order.payer && ord.order.payer.phone){%>
									<a href="#">+55<%=ord.order.payer.phone.area_code%> <%=ord.order.payer.phone.number%></a>
									<%}else{%>
										<a href="#">Contato não encontrado</a>
										<%}%>%>
								</td>
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-number" data-title="E-mail">
									<%if(ord.order.payer && ord.order.payer.email){%>

									<a href="#"><%=ord.order.payer.email%></a>
									<%}else{%>
										<a href="#">E-mail não encontrado</a>
										<%}%>%>
								</td>
							
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-date" data-title="Data">
									<%if(ord.order.date_created){%>


										<% 
										// Função para formatar a data
										function formatarData(dataString) {
											const data = new Date(dataString);
											const options = { 
												timeZoneName: 'short',
												year: 'numeric',
												month: '2-digit',
												day: '2-digit',
												hour: '2-digit',
												minute: '2-digit',
												second: '2-digit' 
											};
											return data.toLocaleString('pt-BR', options);
										}
									
										// Data no formato "2024-02-04T13:59:35.970-04:00"
										
									
										// Formatar a data
									
										%>


												<time datetime="<%=ord.order.date_created%>"><%=formatarData(ord.order.date_created)%></time>
												<%}else{%>
													Data não encontrada ou não registrada
													<%}%>
										</td>
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-status" data-title="Status">
									

									<%if(ord.order.status_detail == 'pending_capture' && ord.order.status != undefined){%>
										<%=ord.order.status%>: Captura pendente
										<%}else if(ord.order.status_detail == 'accredited' && ord.order.status != undefined){%>
											<%=ord.order.status%>: Aprovado
											<%}else if(ord.order.status_detail == 'cc_rejected_other_reason' && ord.order.status != undefined){%>
												<%=ord.order.status%>: Pagamento rejeitado por alguma razão
												<%}else if(ord.order.status_detail == 'pending_waiting_transfer' && ord.order.status != undefined){%>
													<%=ord.order.status%>: Pendente aguardando transferência
													<%}else if(ord.order.status_detail == 'pending_contingency' && ord.order.status != undefined){%>
														<%=ord.order.order.status%>: O pagamento está sendo processado
														<%}else if(ord.order.status_detail == 'pending_review_manual' && ord.order.status != undefined){%>
															<%=ord.order.status%>: O pagamento está em análise
															<%}else if(ord.order.status_detail == 'cc_rejected_bad_filled_date' && ord.order.status != undefined){%>
																<%=ord.order.status%>: Data de válidade incorreta
																<%}else if(ord.order.status_detail == 'cc_rejected_bad_filled_other' && ord.order.status != undefined){%>
																	<%=ord.order.status%>: Detalhes incorretos do cartão
																	<%}else if(ord.order.status_detail == 'cc_rejected_bad_filled_security_code' && ord.order.status != undefined){%>
																		<%=ord.order.status%>: CVV incorreto
																		<%}else if(ord.order.status_detail == 'cc_rejected_blacklist' && ord.order.status != undefined){%>
																			<%=ord.order.status%>: O cartão está em uma lista negra(roubo/reclamações/fraude) 
																			<%}else if(ord.order.status_detail == 'cc_rejected_call_for_authorize' && ord.order.status != undefined){%>
																				<%=ord.order.status%>: O meio de pagamento requer autorização prévia do valor da operação
																				<%}else if(ord.order.status_detail = 'cc_rejected_card_disabled' && ord.order.status != undefined){%>
																					<%=ord.order.status%>: O cartão está inativo
																					<%}else if(ord.order.status_detail == 'cc_rejected_duplicated_payment' && ord.order.status != undefined){%>
																						<%=ord.order.status%>: Transação duplicada
																						<%}else if(ord.order.status_detail == 'cc_rejected_high_risk' && ord.order.status != undefined){%>
																							<%=ord.order.status%>: Rechaçado por prevenção de fraude
																							<%}else if(ord.order.status_detail == 'cc_rejected_insufficient_amount' && ord.order.status != undefined){%>
																								<%=ord.order.status%>: Saldo insuficiente
																								<%}else if(ord.order.status_detail == 'cc_rejected_invalid_installments' && ord.order.status != undefined){%>
																									<%=payment.status%>: Número de parcelas inválido
																									<%}else if(ord.order.status_detail == 'cc_rejected_max_attempts' && ord.order.status != undefined){%>
																										<%=ord.order.status%>: Número máximo de tentativas excedido
																										<%}else{%>
																												<%console.log('log')%>
																											<%}%>
												
										</td>
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-total" data-title="Total">
												<span class="woocommerce-Price-amount amount"><span class="woocommerce-Price-currencySymbol"><%=ord.order.currency_id%></span>&nbsp;<%=ord.order.transaction_amount%></span>
										</td>
										<%if(ord.order.status_detail == 'accredited' && ord.order.status != undefined){%>
								<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-actions" data-title="Ações">
											<a href="#">	<button type="button" disabled  class="woocommerce-button button view">Visualizar Bag</button>	</a>											
												</td>
												<%}else{%>
											<td class="woocommerce-orders-table__cell woocommerce-orders-table__cell-order-actions" data-title="Ações">
												
											<a href="/pedido/<%=ord.order.id%>">	<button type="button"  class="woocommerce-button button view">Visualizar Bag</button>	</a>											
												</td>
													<%}%>
						</tr>
						

				


					
						<%})%>
						<%}%>	
			</tbody>



  




</table>
<%if(msg){%>
<h4><%msg.message%></h4>
	<%}%>
	
	

	

</div>
